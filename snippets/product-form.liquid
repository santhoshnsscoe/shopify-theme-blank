{%- doc -%}
  Renders a product form for a product variant.

  @param {product} current_product - Current product object (required)
  @param {variant} current_variant - Current variant object (required)
  @param {boolean} section_settings - Section settings object (required)

  @example
  {% render 'product-form', current_product: product, current_variant: current_variant %}
{%- enddoc -%}

{% liquid
  assign available = current_variant.available
%}

<div class="product__form">
  {% form 'product', current_product, class: 'product__form-form' %}
    {% if current_product.variants.size > 1 %}
      {% if section_settings.picker_type == 'select' %}
        <select class="product__form-select" name="id">
          {% for variant in current_product.variants %}
            <option
              value="{{ variant.id }}"
              {% if variant == current_variant %}
                selected="selected"
              {% endif %}
            >
              {{ variant.title }} - {{ variant.price | money }}
            </option>
          {% endfor %}
        </select>
      {% else %}
        <input type="hidden" name="id" value="{{ current_variant.id }}">
        <div class="product__form-pills">
          {% for variant in current_product.variants %}
            <button
              class="product__form-pill {% if variant == current_variant %}active{% endif %}{% unless variant.available %}disabled{% endunless %}"
              data-id="{{ variant.id }}"
              data-available="{{ variant.available }}"
              data-price="{{ variant.price | money | json }}"
              data-compare-price="{{ variant.compare_at_price | money | json }}"
              data-on-sale="{% if variant.compare_at_price > variant.price %}true{% else %}false{% endif %}"
              data-title="{{ variant.title }}"
            >
              {{ variant.title }}
            </button>
          {% endfor %}
        </div>
      {% endif %}
    {% else %}
      <input type="hidden" name="id" value="{{ current_variant.id }}">
    {% endif %}

    <div class="product__form-quantity">
      <label for="quantity">{{ 'product.quantity' | t }}</label>
      <input type="text" name="quantity" min="1" value="1">
    </div>

    {% if available %}
      <div class="product__form-buttons">
        <input type="submit" class="product__form-submit" value="{{ 'product.add_to_cart' | t }}">
        {{ form | payment_button }}
      </div>
    {% else %}
      <div class="product__form-buttons">
        <input type="submit" class="product__form-submit" disabled value="{{ 'product.sold_out' | t }}">
      </div>
    {% endif %}
  {% endform %}
</div>

{% stylesheet %}
  .product__form-form {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .product__form-quantity {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .product__form-quantity input {
    width: 100%;
    max-width: 100px;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
    font-weight: 400;
    color: #333;
  }
  .product__form-buttons {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .product__form-submit {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
    font-weight: 400;
    color: #333;
    cursor: pointer;
  }
  .product__form-submit:hover {
    background-color: #333;
    color: #fff;
  }
  .product__form-submit:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  .product__form-select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
    font-weight: 400;
    color: #333;
  }
  .product__form-pills {
    display: flex;
    flex-direction: row;
    gap: 10px;
    flex-wrap: wrap;
  }
  .product__form-pill {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 20px;
    min-width: 70px;
    cursor: pointer;
  }
  .product__form-pill.active {
    background-color: #333;
    color: #fff;
  }
  .product__form-pill.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    text-decoration: line-through;
  }
  .product__form-pill:hover {
    background-color: #ccc;
    color: #333;
  }
{% endstylesheet %}
